{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "5aa0d48e-bd27-410e-ad6a-384e5f2e6c65",
   "metadata": {},
   "source": [
    "import sqlite3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "01b4afa6-142e-4c15-9b71-f32fc03412cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "2334a108-d53d-481f-9f5a-4bf9d5e33f4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "e705d85f-42c8-47b4-b1f2-4a3f4f614669",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_parquet('https://ftp.ebi.ac.uk/pub/databases/opentargets/platform/24.09/output/etl/parquet/targets/part-00000-b2a23987-7e43-4651-a89c-1eb34ec9f9f5-c000.snappy.parquet')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "2515ad7c-7c7b-4734-87c8-8a3a17f333a3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>approvedSymbol</th>\n",
       "      <th>biotype</th>\n",
       "      <th>transcriptIds</th>\n",
       "      <th>canonicalTranscript</th>\n",
       "      <th>canonicalExons</th>\n",
       "      <th>genomicLocation</th>\n",
       "      <th>alternativeGenes</th>\n",
       "      <th>approvedName</th>\n",
       "      <th>go</th>\n",
       "      <th>...</th>\n",
       "      <th>obsoleteNames</th>\n",
       "      <th>constraint</th>\n",
       "      <th>tep</th>\n",
       "      <th>proteinIds</th>\n",
       "      <th>dbXrefs</th>\n",
       "      <th>chemicalProbes</th>\n",
       "      <th>homologues</th>\n",
       "      <th>tractability</th>\n",
       "      <th>safetyLiabilities</th>\n",
       "      <th>pathways</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ENSG00000020219</td>\n",
       "      <td>CCT8L1P</td>\n",
       "      <td>processed_pseudogene</td>\n",
       "      <td>[ENST00000465400]</td>\n",
       "      <td>{'id': 'ENST00000465400', 'chromosome': '7', '...</td>\n",
       "      <td>[152445477, 152447150]</td>\n",
       "      <td>{'chromosome': '7', 'start': 152445477, 'end':...</td>\n",
       "      <td>None</td>\n",
       "      <td>chaperonin containing TCP1 subunit 8 like 1, p...</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'label': 'chaperonin containing TCP1, subuni...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'A6NM43', 'source': 'uniprot_obsolete'}]</td>\n",
       "      <td>[{'id': '32153', 'source': 'HGNC'}, {'id': 'IP...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ENSG00000059588</td>\n",
       "      <td>TARBP1</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000496673, ENST00000483404, ENST0000048...</td>\n",
       "      <td>{'id': 'ENST00000040877', 'chromosome': '1', '...</td>\n",
       "      <td>[234420702, 234420812, 234425673, 234425793, 2...</td>\n",
       "      <td>{'chromosome': '1', 'start': 234391313, 'end':...</td>\n",
       "      <td>None</td>\n",
       "      <td>TAR (HIV-1) RNA binding protein 1</td>\n",
       "      <td>[{'id': 'GO:0006357', 'source': 'PMID:8846792'...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'label': 'Tar (HIV-1) RNA binding protein 1'...</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': 0.88121002...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'Q13395', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '11568', 'source': 'HGNC'}, {'id': '2H...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9606', 'speciesName': 'Human',...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ENSG00000070182</td>\n",
       "      <td>SPTB</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000553938, ENST00000389720, ENST0000055...</td>\n",
       "      <td>{'id': 'ENST00000644917', 'chromosome': '14', ...</td>\n",
       "      <td>[64785537, 64785627, 64774397, 64774527, 64769...</td>\n",
       "      <td>{'chromosome': '14', 'start': 64746283, 'end':...</td>\n",
       "      <td>None</td>\n",
       "      <td>spectrin beta, erythrocytic</td>\n",
       "      <td>[{'id': 'GO:0030506', 'source': 'PMID:8159688'...</td>\n",
       "      <td>...</td>\n",
       "      <td>[]</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': -2.2815999...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'P11277', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '11274', 'source': 'HGNC'}, {'id': '1S...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9606', 'speciesName': 'Human',...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'pathwayId': 'R-HSA-6807878', 'pathway': 'CO...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ENSG00000070366</td>\n",
       "      <td>SMG6</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000354901, ENST00000570756, ENST0000026...</td>\n",
       "      <td>{'id': 'ENST00000263073', 'chromosome': '17', ...</td>\n",
       "      <td>[2172658, 2172859, 2292871, 2292977, 2297863, ...</td>\n",
       "      <td>{'chromosome': '17', 'start': 2059839, 'end': ...</td>\n",
       "      <td>None</td>\n",
       "      <td>SMG6 nonsense mediated mRNA decay factor</td>\n",
       "      <td>[{'id': 'GO:1904354', 'source': 'PMID:12676087...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'label': 'chromosome 17 open reading frame 3...</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': -2.2750000...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'Q86US8', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '17809', 'source': 'HGNC'}, {'id': '2D...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9598', 'speciesName': 'Chimpan...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'pathwayId': 'R-HSA-975957', 'pathway': 'Non...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ENSG00000072071</td>\n",
       "      <td>ADGRL1</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000361434, ENST00000589616, ENST0000059...</td>\n",
       "      <td>{'id': 'ENST00000361434', 'chromosome': '19', ...</td>\n",
       "      <td>[14160112, 14160297, 14159401, 14159584, 14155...</td>\n",
       "      <td>{'chromosome': '19', 'start': 14147743, 'end':...</td>\n",
       "      <td>[ENSG00000288324]</td>\n",
       "      <td>adhesion G protein-coupled receptor L1</td>\n",
       "      <td>[{'id': 'GO:0016524', 'source': 'GO_REF:000002...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'label': 'latrophilin 1', 'source': 'HGNC'}]</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': -1.7188999...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'O94910', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '20973', 'source': 'HGNC'}, {'id': 'IP...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9606', 'speciesName': 'Human',...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>ENSG00000073536</td>\n",
       "      <td>NLE1</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000589367, ENST00000360831, ENST0000044...</td>\n",
       "      <td>{'id': 'ENST00000442241', 'chromosome': '17', ...</td>\n",
       "      <td>[35133339, 35133498, 35135249, 35135451, 35136...</td>\n",
       "      <td>{'chromosome': '17', 'start': 35128730, 'end':...</td>\n",
       "      <td>None</td>\n",
       "      <td>notchless homolog 1</td>\n",
       "      <td>[{'id': 'GO:0007219', 'source': 'GO_REF:000003...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'label': 'notchless homolog (Drosophila)', '...</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': 0.73973000...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'Q9NVX2', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '19889', 'source': 'HGNC'}, {'id': '6W...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9598', 'speciesName': 'Chimpan...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>ENSG00000075290</td>\n",
       "      <td>WNT8B</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000343737]</td>\n",
       "      <td>{'id': 'ENST00000343737', 'chromosome': '10', ...</td>\n",
       "      <td>[100479874, 100480012, 100480998, 100481123, 1...</td>\n",
       "      <td>{'chromosome': '10', 'start': 100463009, 'end'...</td>\n",
       "      <td>None</td>\n",
       "      <td>Wnt family member 8B</td>\n",
       "      <td>[{'id': 'GO:0060070', 'source': 'PMID:28733458...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'label': 'wingless-type MMTV integration sit...</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': 0.16899999...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'Q93098', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '12789', 'source': 'HGNC'}, {'id': 'R-...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9606', 'speciesName': 'Human',...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'pathwayId': 'R-HSA-201681', 'pathway': 'TCF...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>ENSG00000083454</td>\n",
       "      <td>P2RX5</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000552276, ENST00000551178, ENST0000055...</td>\n",
       "      <td>{'id': 'ENST00000225328', 'chromosome': '17', ...</td>\n",
       "      <td>[3695869, 3696155, 3673227, 3673877, 3690605, ...</td>\n",
       "      <td>{'chromosome': '17', 'start': 3672199, 'end': ...</td>\n",
       "      <td>None</td>\n",
       "      <td>purinergic receptor P2X 5</td>\n",
       "      <td>[{'id': 'GO:0010524', 'source': 'PMID:17895406...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'label': 'purinergic receptor P2X, ligand-ga...</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': -0.7249799...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'Q93086', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '8536', 'source': 'HGNC'}, {'id': 'CHE...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9606', 'speciesName': 'Human',...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>[{'event': 'hemolysis', 'eventId': 'EFO_000947...</td>\n",
       "      <td>[{'pathwayId': 'R-HSA-418346', 'pathway': 'Pla...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>ENSG00000083782</td>\n",
       "      <td>EPYC</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000261172, ENST00000551767, ENST0000055...</td>\n",
       "      <td>{'id': 'ENST00000261172', 'chromosome': '12', ...</td>\n",
       "      <td>[90970044, 90970139, 90972822, 90972980, 90963...</td>\n",
       "      <td>{'chromosome': '12', 'start': 90963682, 'end':...</td>\n",
       "      <td>None</td>\n",
       "      <td>epiphycan</td>\n",
       "      <td>[{'id': 'GO:0060348', 'source': 'GO_REF:000003...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'label': 'dermatan sulphate proteoglycan 3',...</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': 0.35929000...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'Q99645', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '3053', 'source': 'HGNC'}, {'id': 'IPR...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9606', 'speciesName': 'Human',...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>ENSG00000086200</td>\n",
       "      <td>IPO11</td>\n",
       "      <td>protein_coding</td>\n",
       "      <td>[ENST00000409296, ENST00000506905, ENST0000051...</td>\n",
       "      <td>{'id': 'ENST00000325324', 'chromosome': '5', '...</td>\n",
       "      <td>[62442983, 62443083, 62449927, 62449999, 62506...</td>\n",
       "      <td>{'chromosome': '5', 'start': 62403972, 'end': ...</td>\n",
       "      <td>None</td>\n",
       "      <td>importin 11</td>\n",
       "      <td>[{'id': 'GO:0005829', 'source': 'GO_REF:000003...</td>\n",
       "      <td>...</td>\n",
       "      <td>[]</td>\n",
       "      <td>[{'constraintType': 'syn', 'score': 0.53096002...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'id': 'Q9UI26', 'source': 'uniprot_swissprot...</td>\n",
       "      <td>[{'id': '20628', 'source': 'HGNC'}, {'id': 'IP...</td>\n",
       "      <td>None</td>\n",
       "      <td>[{'speciesId': '9606', 'speciesName': 'Human',...</td>\n",
       "      <td>[{'modality': 'SM', 'id': 'Approved Drug', 'va...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows Ã— 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                id approvedSymbol               biotype  \\\n",
       "0  ENSG00000020219        CCT8L1P  processed_pseudogene   \n",
       "1  ENSG00000059588         TARBP1        protein_coding   \n",
       "2  ENSG00000070182           SPTB        protein_coding   \n",
       "3  ENSG00000070366           SMG6        protein_coding   \n",
       "4  ENSG00000072071         ADGRL1        protein_coding   \n",
       "5  ENSG00000073536           NLE1        protein_coding   \n",
       "6  ENSG00000075290          WNT8B        protein_coding   \n",
       "7  ENSG00000083454          P2RX5        protein_coding   \n",
       "8  ENSG00000083782           EPYC        protein_coding   \n",
       "9  ENSG00000086200          IPO11        protein_coding   \n",
       "\n",
       "                                       transcriptIds  \\\n",
       "0                                  [ENST00000465400]   \n",
       "1  [ENST00000496673, ENST00000483404, ENST0000048...   \n",
       "2  [ENST00000553938, ENST00000389720, ENST0000055...   \n",
       "3  [ENST00000354901, ENST00000570756, ENST0000026...   \n",
       "4  [ENST00000361434, ENST00000589616, ENST0000059...   \n",
       "5  [ENST00000589367, ENST00000360831, ENST0000044...   \n",
       "6                                  [ENST00000343737]   \n",
       "7  [ENST00000552276, ENST00000551178, ENST0000055...   \n",
       "8  [ENST00000261172, ENST00000551767, ENST0000055...   \n",
       "9  [ENST00000409296, ENST00000506905, ENST0000051...   \n",
       "\n",
       "                                 canonicalTranscript  \\\n",
       "0  {'id': 'ENST00000465400', 'chromosome': '7', '...   \n",
       "1  {'id': 'ENST00000040877', 'chromosome': '1', '...   \n",
       "2  {'id': 'ENST00000644917', 'chromosome': '14', ...   \n",
       "3  {'id': 'ENST00000263073', 'chromosome': '17', ...   \n",
       "4  {'id': 'ENST00000361434', 'chromosome': '19', ...   \n",
       "5  {'id': 'ENST00000442241', 'chromosome': '17', ...   \n",
       "6  {'id': 'ENST00000343737', 'chromosome': '10', ...   \n",
       "7  {'id': 'ENST00000225328', 'chromosome': '17', ...   \n",
       "8  {'id': 'ENST00000261172', 'chromosome': '12', ...   \n",
       "9  {'id': 'ENST00000325324', 'chromosome': '5', '...   \n",
       "\n",
       "                                      canonicalExons  \\\n",
       "0                             [152445477, 152447150]   \n",
       "1  [234420702, 234420812, 234425673, 234425793, 2...   \n",
       "2  [64785537, 64785627, 64774397, 64774527, 64769...   \n",
       "3  [2172658, 2172859, 2292871, 2292977, 2297863, ...   \n",
       "4  [14160112, 14160297, 14159401, 14159584, 14155...   \n",
       "5  [35133339, 35133498, 35135249, 35135451, 35136...   \n",
       "6  [100479874, 100480012, 100480998, 100481123, 1...   \n",
       "7  [3695869, 3696155, 3673227, 3673877, 3690605, ...   \n",
       "8  [90970044, 90970139, 90972822, 90972980, 90963...   \n",
       "9  [62442983, 62443083, 62449927, 62449999, 62506...   \n",
       "\n",
       "                                     genomicLocation   alternativeGenes  \\\n",
       "0  {'chromosome': '7', 'start': 152445477, 'end':...               None   \n",
       "1  {'chromosome': '1', 'start': 234391313, 'end':...               None   \n",
       "2  {'chromosome': '14', 'start': 64746283, 'end':...               None   \n",
       "3  {'chromosome': '17', 'start': 2059839, 'end': ...               None   \n",
       "4  {'chromosome': '19', 'start': 14147743, 'end':...  [ENSG00000288324]   \n",
       "5  {'chromosome': '17', 'start': 35128730, 'end':...               None   \n",
       "6  {'chromosome': '10', 'start': 100463009, 'end'...               None   \n",
       "7  {'chromosome': '17', 'start': 3672199, 'end': ...               None   \n",
       "8  {'chromosome': '12', 'start': 90963682, 'end':...               None   \n",
       "9  {'chromosome': '5', 'start': 62403972, 'end': ...               None   \n",
       "\n",
       "                                        approvedName  \\\n",
       "0  chaperonin containing TCP1 subunit 8 like 1, p...   \n",
       "1                  TAR (HIV-1) RNA binding protein 1   \n",
       "2                        spectrin beta, erythrocytic   \n",
       "3           SMG6 nonsense mediated mRNA decay factor   \n",
       "4             adhesion G protein-coupled receptor L1   \n",
       "5                                notchless homolog 1   \n",
       "6                               Wnt family member 8B   \n",
       "7                          purinergic receptor P2X 5   \n",
       "8                                          epiphycan   \n",
       "9                                        importin 11   \n",
       "\n",
       "                                                  go  ...  \\\n",
       "0                                               None  ...   \n",
       "1  [{'id': 'GO:0006357', 'source': 'PMID:8846792'...  ...   \n",
       "2  [{'id': 'GO:0030506', 'source': 'PMID:8159688'...  ...   \n",
       "3  [{'id': 'GO:1904354', 'source': 'PMID:12676087...  ...   \n",
       "4  [{'id': 'GO:0016524', 'source': 'GO_REF:000002...  ...   \n",
       "5  [{'id': 'GO:0007219', 'source': 'GO_REF:000003...  ...   \n",
       "6  [{'id': 'GO:0060070', 'source': 'PMID:28733458...  ...   \n",
       "7  [{'id': 'GO:0010524', 'source': 'PMID:17895406...  ...   \n",
       "8  [{'id': 'GO:0060348', 'source': 'GO_REF:000003...  ...   \n",
       "9  [{'id': 'GO:0005829', 'source': 'GO_REF:000003...  ...   \n",
       "\n",
       "                                       obsoleteNames  \\\n",
       "0  [{'label': 'chaperonin containing TCP1, subuni...   \n",
       "1  [{'label': 'Tar (HIV-1) RNA binding protein 1'...   \n",
       "2                                                 []   \n",
       "3  [{'label': 'chromosome 17 open reading frame 3...   \n",
       "4     [{'label': 'latrophilin 1', 'source': 'HGNC'}]   \n",
       "5  [{'label': 'notchless homolog (Drosophila)', '...   \n",
       "6  [{'label': 'wingless-type MMTV integration sit...   \n",
       "7  [{'label': 'purinergic receptor P2X, ligand-ga...   \n",
       "8  [{'label': 'dermatan sulphate proteoglycan 3',...   \n",
       "9                                                 []   \n",
       "\n",
       "                                          constraint   tep  \\\n",
       "0                                               None  None   \n",
       "1  [{'constraintType': 'syn', 'score': 0.88121002...  None   \n",
       "2  [{'constraintType': 'syn', 'score': -2.2815999...  None   \n",
       "3  [{'constraintType': 'syn', 'score': -2.2750000...  None   \n",
       "4  [{'constraintType': 'syn', 'score': -1.7188999...  None   \n",
       "5  [{'constraintType': 'syn', 'score': 0.73973000...  None   \n",
       "6  [{'constraintType': 'syn', 'score': 0.16899999...  None   \n",
       "7  [{'constraintType': 'syn', 'score': -0.7249799...  None   \n",
       "8  [{'constraintType': 'syn', 'score': 0.35929000...  None   \n",
       "9  [{'constraintType': 'syn', 'score': 0.53096002...  None   \n",
       "\n",
       "                                          proteinIds  \\\n",
       "0   [{'id': 'A6NM43', 'source': 'uniprot_obsolete'}]   \n",
       "1  [{'id': 'Q13395', 'source': 'uniprot_swissprot...   \n",
       "2  [{'id': 'P11277', 'source': 'uniprot_swissprot...   \n",
       "3  [{'id': 'Q86US8', 'source': 'uniprot_swissprot...   \n",
       "4  [{'id': 'O94910', 'source': 'uniprot_swissprot...   \n",
       "5  [{'id': 'Q9NVX2', 'source': 'uniprot_swissprot...   \n",
       "6  [{'id': 'Q93098', 'source': 'uniprot_swissprot...   \n",
       "7  [{'id': 'Q93086', 'source': 'uniprot_swissprot...   \n",
       "8  [{'id': 'Q99645', 'source': 'uniprot_swissprot...   \n",
       "9  [{'id': 'Q9UI26', 'source': 'uniprot_swissprot...   \n",
       "\n",
       "                                             dbXrefs chemicalProbes  \\\n",
       "0  [{'id': '32153', 'source': 'HGNC'}, {'id': 'IP...           None   \n",
       "1  [{'id': '11568', 'source': 'HGNC'}, {'id': '2H...           None   \n",
       "2  [{'id': '11274', 'source': 'HGNC'}, {'id': '1S...           None   \n",
       "3  [{'id': '17809', 'source': 'HGNC'}, {'id': '2D...           None   \n",
       "4  [{'id': '20973', 'source': 'HGNC'}, {'id': 'IP...           None   \n",
       "5  [{'id': '19889', 'source': 'HGNC'}, {'id': '6W...           None   \n",
       "6  [{'id': '12789', 'source': 'HGNC'}, {'id': 'R-...           None   \n",
       "7  [{'id': '8536', 'source': 'HGNC'}, {'id': 'CHE...           None   \n",
       "8  [{'id': '3053', 'source': 'HGNC'}, {'id': 'IPR...           None   \n",
       "9  [{'id': '20628', 'source': 'HGNC'}, {'id': 'IP...           None   \n",
       "\n",
       "                                          homologues  \\\n",
       "0                                               None   \n",
       "1  [{'speciesId': '9606', 'speciesName': 'Human',...   \n",
       "2  [{'speciesId': '9606', 'speciesName': 'Human',...   \n",
       "3  [{'speciesId': '9598', 'speciesName': 'Chimpan...   \n",
       "4  [{'speciesId': '9606', 'speciesName': 'Human',...   \n",
       "5  [{'speciesId': '9598', 'speciesName': 'Chimpan...   \n",
       "6  [{'speciesId': '9606', 'speciesName': 'Human',...   \n",
       "7  [{'speciesId': '9606', 'speciesName': 'Human',...   \n",
       "8  [{'speciesId': '9606', 'speciesName': 'Human',...   \n",
       "9  [{'speciesId': '9606', 'speciesName': 'Human',...   \n",
       "\n",
       "                                        tractability  \\\n",
       "0                                               None   \n",
       "1  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "2  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "3  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "4  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "5  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "6  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "7  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "8  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "9  [{'modality': 'SM', 'id': 'Approved Drug', 'va...   \n",
       "\n",
       "                                   safetyLiabilities  \\\n",
       "0                                               None   \n",
       "1                                               None   \n",
       "2                                               None   \n",
       "3                                               None   \n",
       "4                                               None   \n",
       "5                                               None   \n",
       "6                                               None   \n",
       "7  [{'event': 'hemolysis', 'eventId': 'EFO_000947...   \n",
       "8                                               None   \n",
       "9                                               None   \n",
       "\n",
       "                                            pathways  \n",
       "0                                               None  \n",
       "1                                               None  \n",
       "2  [{'pathwayId': 'R-HSA-6807878', 'pathway': 'CO...  \n",
       "3  [{'pathwayId': 'R-HSA-975957', 'pathway': 'Non...  \n",
       "4                                               None  \n",
       "5                                               None  \n",
       "6  [{'pathwayId': 'R-HSA-201681', 'pathway': 'TCF...  \n",
       "7  [{'pathwayId': 'R-HSA-418346', 'pathway': 'Pla...  \n",
       "8                                               None  \n",
       "9                                               None  \n",
       "\n",
       "[10 rows x 28 columns]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(10)"
   ]
  },
  {
   "cell_type": "raw",
   "id": "1b76362b-9ea7-4b15-865c-eb863d713c39",
   "metadata": {},
   "source": [
    " string_df.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "7c970e08-2768-4a58-8883-20070d8ffb19",
   "metadata": {},
   "outputs": [],
   "source": [
    "conn = sqlite3.connect('etl_pipeline.db')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "cd3b80e0-3058-4a24-8432-e3b66d1fd646",
   "metadata": {},
   "outputs": [],
   "source": [
    "create_sql = '''CREATE TABLE IF NOT EXISTS clean_uniprot (\n",
    "        primary_accession TEXT,\n",
    "        recommended_protein_name TEXT,\n",
    "        primary_gene_name TEXT,\n",
    "        species_common_name TEXT,\n",
    "        string_dbReference TEXT,\n",
    "        opentargets_dbReference TEXT,\n",
    "        sequence_length INTEGER,\n",
    "        sequence_mass REAL\n",
    "    )'''"
   ]
  },
  {
   "cell_type": "raw",
   "id": "8e9abb23-ab56-43bf-b98d-f62da0db6970",
   "metadata": {},
   "source": [
    "cursor.execute(create_sql)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1f486c7d-153c-458c-b9d8-969c808532bc",
   "metadata": {},
   "outputs": [],
   "source": [
    "cursor = conn.cursor()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "ebfa2ee2-d429-4c4a-a783-e28798cf779c",
   "metadata": {},
   "outputs": [],
   "source": [
    "conn.commit()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "d22e65d6-d774-4b78-b1a3-8357412fa8b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "conn.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "41595a88-f6e4-4daf-ba79-8499170c26bc",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a9784ddf-faaf-4c3b-9554-c3808fd8e165",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
